<!DOCTYPE html>
<html lang="id">
<head>
  <!-- ============================================================
       METADATA DASAR
       - Charset UTF-8 agar karakter Indonesia tampil benar
       - Viewport untuk tampilan responsif di mobile
       ============================================================ -->
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

  <!-- ============================================================
       JUDUL HALAMAN
       ============================================================ -->
  <title>CSIPBLLM â€” Personalized Learning System</title>

  <!-- ============================================================
       CSS
       PENTING: gunakan path absolut /static/ agar FastAPI bisa serve
       ============================================================ -->
  <link rel="stylesheet" href="/static/style.css"/>
</head>
<body>
  <!-- ============================================================
       WRAPPER / CONTAINER UTAMA
       ============================================================ -->
  <div class="container">

    <!-- ==========================================================
         HEADER / TITLE
         ========================================================== -->
    <h1>Personalized Learning System</h1>
    <p class="subtitle">Ditenagai oleh <b>Ollama GPT-OSS</b></p>

    <!-- ==========================================================
         PROFIL PENGGUNA
         - Disimpan untuk konteks (profesi & usia)
         - Tidak mengubah struktur, ID tetap sama (profesi, usia)
         ========================================================== -->
    <section class="profile-section">
      <h3>Profil Pengguna</h3>
      <p>Informasi ini membantu sistem menyesuaikan gaya penjelasan sesuai karakter kamu.</p>

      <!-- input profesi -->
      <input
        type="text"
        id="profesi"
        placeholder="Profesi kamu (contoh: Siswa, Guru, Mahasiswa...)"
        autocomplete="on"
      />

      <!-- input usia -->
      <input
        type="number"
        id="usia"
        placeholder="Usia kamu"
        min="5"
        max="110"
        inputmode="numeric"
      />
    </section>

    <!-- ==========================================================
         PERTANYAAN / MATERI
         - ID dan urutan tombol dipertahankan
         - Dropdown TANPA 'netral' (hanya 3 tipe)
         ========================================================== -->
    <section class="question-section">
      <h3>Pertanyaan / Materi</h3>

      <!-- textarea pertanyaan -->
      <textarea
        id="question"
        placeholder="Tulis pertanyaan atau topik yang ingin kamu pelajari..."
        rows="4"
      ></textarea>

      <!-- pilihan tipe kognitif & CQ -->
      <div class="cognitive-wrapper">
        <div class="cognitive-field">
          <label for="cognitive">Tipe Kognitif:</label>
          <select id="cognitive">
            <option value="par" selected>PAR â€” Practical-Analytical</option>
            <option value="tar">TAR â€” Theoretical-Analytical</option>
          </select>
        </div>

        <div class="cognitive-field">
          <label for="cq1">CQ1:</label>
          <select id="cq1">
            <option value="t" selected>T â€” Teoretis / Thinking</option>
            <option value="a">A â€” Analitis / Abstract</option>
            <option value="p">P â€” Praktis / Project</option>
            <option value="none">NONE</option>
          </select>
        </div>

        <div class="cognitive-field">
          <label for="cq2">CQ2:</label>
          <select id="cq2">
            <option value="a" selected>A â€” Analitis / Abstract</option>
            <option value="t">T â€” Teoretis / Thinking</option>
            <option value="p">P â€” Praktis / Project</option>
            <option value="none">NONE</option>
          </select>
        </div>

        <!-- ðŸ”¹ BARU: pilih mode backend (fast vs accurate/CRAG) -->
        <div class="cognitive-field">
          <label for="mode">Mode Jawaban:</label>
          <select id="mode">
            <option value="fast">Cepat â€” lebih ringan</option>
            <option value="accurate" selected>Teliti â€” CRAG aktif</option>
          </select>
        </div>
      </div>
      <p class="note">Gunakan kombinasi Cognitive + CQ1 + CQ2 dari matriks kebutuhanmu.</p>

      <!-- tombol kirim pertanyaan (ID dipertahankan) -->
      <button id="sendBtn" title="Kirim ke bot">Kirim Pertanyaan</button>
    </section>

    <!-- ==========================================================
         PERCAKAPAN
         - Chat log tampil berurutan (user â†’ bot â†’ compare)
         - Bubble â€œloadingâ€ akan dihapus saat jawaban selesai
         ========================================================== -->
    <section class="chat-section">
      <h3>Percakapan</h3>

      <!-- chatBox: placeholder awal akan tergantikan oleh bubble -->
      <div id="chatBox" aria-live="polite">
        <p class="placeholder">
          Belum ada percakapan. Tulis pertanyaan di atas dan klik <b>Kirim</b>.
        </p>
      </div>
    </section>

    <!-- ==========================================================
         PERTANYAAN LANJUTAN (TERPISAH DARI BUBBLE JAWABAN)
         ========================================================== -->
    <section class="followup-section" id="followupSection" style="display:none;">
      <h3>Pertanyaan Lanjutan</h3>
      <div class="followup-card" id="followupCard">
        <p id="followupStage" class="followup-meta" style="display:none;"></p>
        <p id="followupText"></p>
      </div>
    </section>

    <!-- ==========================================================
         JAWABAN SISWA
         - Hanya tampil SETELAH bot menjawab
         - ID & struktur dipertahankan
         ========================================================== -->
    <section class="answer-section" id="answerSection" style="display:none;">
      <h3>Jawaban Kamu</h3>
      <p>Setelah membaca penjelasan dari bot, tulis jawabanmu di bawah untuk dinilai.</p>

      <textarea
        id="userAnswer"
        placeholder="Tulis jawaban kamu di sini..."
        rows="3"
      ></textarea>

      <!-- tombol kirim jawaban untuk evaluasi -->
      <button id="evalBtn" title="Kirim jawaban untuk dinilai">Kirim Jawaban</button>

      <!-- hasil evaluasi (warna hijau/merah via CSS class) -->
      <div id="evalResult" class="eval-result"></div>
    </section>

    <!-- ==========================================================
         RIWAYAT
         - TOMBOL DOWNLOAD BARU MUNCUL JIKA JAWABAN BENAR âœ…
         - ID dipertahankan (historySection, downloadTxt, downloadJson)
         ========================================================== -->
    <section class="history-section" id="historySection" style="display:none;">
      <h3>Unduh Riwayat Percakapan</h3>
      <p class="note">Tombol akan muncul setelah jawaban kamu dinilai <b>Benar</b>.</p>

      <div id="historyButtons" style="display:none;">
        <button id="downloadTxt" title="Unduh sebagai .txt">Download TXT</button>
        <button id="downloadJson" title="Unduh sebagai .json">Download JSON</button>
      </div>
    </section>

    <!-- ==========================================================
         FOOTER
         ========================================================== -->
    <footer>
      Â© 2025 CSIPBLLM Personalized Learning â€” Powered by Ollama GPT-OSS
    </footer>
  </div>

  <!-- ============================================================
       JAVASCRIPT
       PENTING: gunakan /static/script.js (bukan relatif)
       ============================================================ -->
  <script src="/static/script.js"></script>
</body>
</html>
